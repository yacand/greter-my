var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a]);e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)},dragonBones;!function(e){var t=function(t){function a(){t.call(this)}return __extends(a,t),a.toString=function(){return"[class dragonBones.PixiTextureAtlasData]"},a.prototype._onClear=function(){t.prototype._onClear.call(this),this.texture&&(this.texture=null)},a.prototype.generateTextureData=function(){return e.BaseObject.borrowObject(r)},a}(e.TextureAtlasData);e.PixiTextureAtlasData=t;var r=function(e){function t(){e.call(this)}return __extends(t,e),t.toString=function(){return"[class dragonBones.PixiTextureData]"},t.prototype._onClear=function(){e.prototype._onClear.call(this),this.texture&&(this.texture.destroy(!1),this.texture=null)},t}(e.TextureData);e.PixiTextureData=r}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function r(){t.call(this),this._subTextures={}}return __extends(r,t),r.prototype._onClear=function(){for(var e in this._subTextures)this._subTextures[e].destroy(),delete this._subTextures[e];this._debugDrawer&&this._debugDrawer.destroy(!0),this._armature&&this.advanceTimeBySelf(!1),this._armature=null,this._debugDrawer=null,this.destroy()},r.prototype._dispatchEvent=function(e){this.emit(e.type,e)},r.prototype._debugDraw=function(){this._debugDrawer||(this._debugDrawer=new PIXI.Graphics),this.addChild(this._debugDrawer),this._debugDrawer.clear();for(var e=this._armature.getBones(),t=0,r=e.length;t<r;++t){var a=e[t],i=Math.max(a.length,5),n=a.globalTransformMatrix.tx,s=a.globalTransformMatrix.ty,o=n+a.globalTransformMatrix.a*i,l=s+a.globalTransformMatrix.b*i;this._debugDrawer.lineStyle(1,a.ik?16711680:65280,.5),this._debugDrawer.moveTo(n,s),this._debugDrawer.lineTo(o,l)}},r.prototype._onReplaceTexture=function(e){for(var t in this._subTextures)delete this._subTextures[t]},r.prototype.hasEvent=function(e){return this.listeners(e,!0)},r.prototype.addEvent=function(e,t,r){this.addListener(e,t,r)},r.prototype.removeEvent=function(e,t,r){this.removeListener(e,t,r)},r.prototype.advanceTimeBySelf=function(t){t?e.PixiFactory._clock.add(this._armature):e.PixiFactory._clock.remove(this._armature)},r.prototype.dispose=function(){this._armature&&(this.advanceTimeBySelf(!1),this._armature.dispose(),this._armature=null)},Object.defineProperty(r.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"animation",{get:function(){return this._armature.animation},enumerable:!0,configurable:!0}),r}(PIXI.Container);e.PixiArmatureDisplay=t}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(e){function t(){e.call(this)}return __extends(t,e),t.toString=function(){return"[class dragonBones.PixiSlot]"},t.prototype._createTexture=function(e,t){var r=new PIXI.Rectangle(0,0,e.region.width,e.region.height),a=new PIXI.Texture(t,e.region,e.region,r,e.rotated);return a},t.prototype._onClear=function(){e.prototype._onClear.call(this),this._renderDisplay=null},t.prototype._initDisplay=function(e){},t.prototype._disposeDisplay=function(e){e.destroy()},t.prototype._onUpdateDisplay=function(){this._rawDisplay||(this._rawDisplay=new PIXI.Sprite),this._renderDisplay=this._display||this._rawDisplay},t.prototype._addDisplay=function(){var e=this._armature._display;e.addChild(this._renderDisplay)},t.prototype._replaceDisplay=function(e){var t=this._armature._display,r=e;t.addChild(this._renderDisplay),t.swapChildren(this._renderDisplay,r),t.removeChild(r)},t.prototype._removeDisplay=function(){this._renderDisplay.parent.removeChild(this._renderDisplay)},t.prototype._updateZOrder=function(){var e=this._armature._display;e.addChildAt(this._renderDisplay,this._zOrder)},t.prototype._updateVisible=function(){this._renderDisplay.visible=this._parent.visible},t.prototype._updateBlendMode=function(){switch(this._blendMode){case 0:this._renderDisplay.blendMode=PIXI.BLEND_MODES.NORMAL;break;case 1:this._renderDisplay.blendMode=PIXI.BLEND_MODES.ADD;break;case 3:this._renderDisplay.blendMode=PIXI.BLEND_MODES.DARKEN;break;case 4:this._renderDisplay.blendMode=PIXI.BLEND_MODES.DIFFERENCE;break;case 6:this._renderDisplay.blendMode=PIXI.BLEND_MODES.HARD_LIGHT;break;case 9:this._renderDisplay.blendMode=PIXI.BLEND_MODES.LIGHTEN;break;case 10:this._renderDisplay.blendMode=PIXI.BLEND_MODES.MULTIPLY;break;case 11:this._renderDisplay.blendMode=PIXI.BLEND_MODES.OVERLAY;break;case 12:this._renderDisplay.blendMode=PIXI.BLEND_MODES.SCREEN}},t.prototype._updateColor=function(){this._renderDisplay.alpha=this._colorTransform.alphaMultiplier},t.prototype._updateFilters=function(){},t.prototype._updateFrame=function(){var e=this._renderDisplay;if(this._display&&this._displayIndex>=0){var t=this._displayIndex<this._displayDataSet.displays.length?this._displayDataSet.displays[this._displayIndex]:null,r=this._displayIndex<this._replacedDisplayDataSet.length?this._replacedDisplayDataSet[this._displayIndex]:null,a=r||t,i=a.texture;if(i){var n=i.parent,s=this._armature.replacedTexture,o=s&&a.texture.parent==t.texture.parent?s:n.texture;if(o){var l=i.texture;if(o==s){var u=this._armature._display,h=i.name;l=u._subTextures[h],l||(l=this._createTexture(i,o),u._subTextures[h]=l)}else i.texture||(l=this._createTexture(i,o),i.texture=l);if(this._updatePivot(t,a,i),this._meshData&&this._display==this._meshDisplay){var p=this._meshDisplay,d=o?o.width:1,_=o?o.height:1;p.uvs=new Float32Array(this._meshData.uvs),p.vertices=new Float32Array(this._meshData.vertices),p.indices=new Uint16Array(this._meshData.vertexIndices);for(var c=0,y=p.uvs.length;c<y;c+=2){var f=p.uvs[c],D=p.uvs[c+1];p.uvs[c]=(i.region.x+f*i.region.width)/d,p.uvs[c+1]=(i.region.y+D*i.region.height)/_}p.texture=l,p.dirty=!0,this._meshData.skinned&&p.setTransform(0,0,1,1,0,0,0,0,0)}else e.texture=l;return void this._updateVisible()}}}this._pivotX=0,this._pivotY=0,e.visible=!1,e.texture=null,e.x=this.origin.x,e.y=this.origin.y},t.prototype._updateMesh=function(){var e=this._meshDisplay,t=this._ffdVertices.length>0;if(this._meshData.skinned)for(var r=0,a=0,i=this._meshData.vertices.length;r<i;r+=2){for(var n=r/2,s=this._meshData.boneIndices[n],o=this._meshData.boneVertices[n],l=this._meshData.weights[n],u=0,h=0,p=0,d=s.length;p<d;++p){var _=this._meshBones[s[p]],c=_.globalTransformMatrix,y=l[p],f=0,D=0;t?(f=o[2*p]+this._ffdVertices[a],D=o[2*p+1]+this._ffdVertices[a+1]):(f=o[2*p],D=o[2*p+1]),u+=(c.a*f+c.c*D+c.tx)*y,h+=(c.b*f+c.d*D+c.ty)*y,a+=2}e.vertices[r]=u,e.vertices[r+1]=h}else if(t)for(var m=this._meshData.vertices,r=0,i=this._meshData.vertices.length;r<i;r+=2){var u=m[r]+this._ffdVertices[r],h=m[r+1]+this._ffdVertices[r+1];e.vertices[r]=u,e.vertices[r+1]=h}},t.prototype._updateTransform=function(){this._renderDisplay.setTransform(this.global.x,this.global.y,this.global.scaleX,this.global.scaleY,this.global.skewY,0,0,this._pivotX,this._pivotY)},t}(e.Slot);e.PixiSlot=t}(dragonBones||(dragonBones={}));var dragonBones;!function(e){var t=function(t){function r(a){void 0===a&&(a=null),t.call(this,a),r._eventManager||(r._eventManager=new e.PixiArmatureDisplay,r._clock=new e.WorldClock,PIXI.ticker.shared.add(r._clockHandler,r))}return __extends(r,t),r._clockHandler=function(e){r._clock.advanceTime(-1)},Object.defineProperty(r,"factory",{get:function(){return r._factory||(r._factory=new r),r._factory},enumerable:!0,configurable:!0}),r.prototype._generateTextureAtlasData=function(t,r){return t?t.texture=r:t=e.BaseObject.borrowObject(e.PixiTextureAtlasData),t},r.prototype._generateArmature=function(t){var a=e.BaseObject.borrowObject(e.Armature),i=new e.PixiArmatureDisplay;return a._armatureData=t.armature,a._skinData=t.skin,a._animation=e.BaseObject.borrowObject(e.Animation),a._display=i,a._eventManager=r._eventManager,i._armature=a,a._animation._armature=a,a.animation.animations=t.armature.animations,a},r.prototype._generateSlot=function(t,r,a){var i=e.BaseObject.borrowObject(e.PixiSlot),n=r.slot,s=[];i.name=n.name,i._rawDisplay=new PIXI.Sprite,i._meshDisplay=new PIXI.mesh.Mesh(null,null,null,null,PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES);for(var o=0,l=r.displays.length;o<l;++o){var u=r.displays[o];switch(u.type){case 0:u.texture&&!t.textureAtlasName||(u.texture=this._getTextureData(t.textureAtlasName||t.dataName,u.path)),s.push(i._rawDisplay);break;case 2:u.texture&&!t.textureAtlasName||(u.texture=this._getTextureData(t.textureAtlasName||t.dataName,u.path)),s.push(i._meshDisplay);break;case 1:var h=this.buildArmature(u.path,t.dataName,null,t.textureAtlasName);if(h){if(!i.inheritAnimation){var p=n.actions.length>0?n.actions:h.armatureData.actions;if(p.length>0)for(var d=0,_=p.length;d<_;++d)h._bufferAction(p[d]);else h.animation.play()}u.armature=h.armatureData}s.push(h);break;default:s.push(null)}}return i._setDisplayList(s),i},r.prototype.buildArmatureDisplay=function(e,t,r,a){void 0===t&&(t=null),void 0===r&&(r=null),void 0===a&&(a=null);var i=this.buildArmature(e,t,r,a),n=i?i._display:null;return n&&n.advanceTimeBySelf(!0),n},r.prototype.getTextureDisplay=function(e,t){void 0===t&&(t=null);var r=this._getTextureData(t,e);if(r){if(!r.texture){var a=r.parent.texture,i=new PIXI.Rectangle(0,0,r.region.width,r.region.height);r.texture=new PIXI.Texture(a,null,r.region,i,r.rotated)}return new PIXI.Sprite(r.texture)}return null},Object.defineProperty(r.prototype,"soundEventManater",{get:function(){return r._eventManager},enumerable:!0,configurable:!0}),r._factory=null,r._eventManager=null,r._clock=null,r}(e.BaseFactory);e.PixiFactory=t}(dragonBones||(dragonBones={}));